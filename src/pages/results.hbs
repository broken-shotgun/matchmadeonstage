<!DOCTYPE html>
<html lang="en">
  <head>
    
    <!-- 
      This is the main Handlebars template for the site 
      - When the user visits the homepage or submits a color the app calls the endpoints in server.js
      - The server script passes data in here and the Handlebars code builds it into the HTML page
    -->
    
    <meta charset="utf-8" />
    <link rel="icon" href="https://glitch.com/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>{{seo.title}}</title>
    
    <!-- Meta tags for SEO and social sharing -->
    <link rel="canonical" href="{{seo.url}}">
    <meta name="description" content="{{seo.description}}">
    <meta property="og:title" content="{{seo.title}}">
    <meta property="og:type" content="article">
    <meta property="og:url" content="{{seo.url}}">
    <meta property="og:description" content="{{seo.description}}">
    <meta property="og:image" content="{{seo.image}}">
    <meta name="twitter:card" content="summary">

    <!-- Import the webpage's stylesheet -->
    <link rel="stylesheet" href="/style.css" />
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script>
      const blue = "#239CF7";
      const yellow = "#FDCD00";
      const red = "#DD3D27";

      /**
       * @param amount 0-100, percent filled
       */
      const setFillAmount = (amount) => {
        var a = amount;
        if (amount < 0) a = 0;
        if (amount > 100) a = 100;

        if (a < 33) {
          $(".amount").css("backgroundColor", blue);
          $(".red-circle").css("backgroundColor", blue);
          $(".filler").css("backgroundColor", blue);
        } else if (a < 66) {
          $(".amount").css("backgroundColor", yellow);
          $(".red-circle").css("backgroundColor", yellow);
          $(".filler").css("backgroundColor", yellow);
        } else {
          $(".amount").css("backgroundColor", red);
          $(".red-circle").css("backgroundColor", red);
          $(".filler").css("backgroundColor", red);
        }
        $(".amount").css("height", `${a}%`);
      }
      
      const socket = io();
      
      socket.on("update", (result) => {
        console.log('update', result);
        setFillAmount(result);
      });
      
      $(document).ready(function(){
        $('#VoteHot').click(function(){
          socket.emit('vote', 'hot');
        });

        $('#VoteCold').click(function(){
          socket.emit('vote', 'cold');
        });
      });
    </script>
    
  </head>
  <body>
    <div class="wrapper">
      <div class="content" role="main" style="height: 100%;">
        <div style="display: flex; height: 100%">
          <div class="donation-meter" style="height:auto">
            <span class="glass">
                <span class="amount"></span>
            </span>
            <div class="bulb">
                <span class="red-circle"></span>
                <span class="filler">
                </span>
            </div>  
          </div>
          <img 
             style="height: auto; width fit;"
             src="https://cdn.glitch.global/b70d6866-7003-4c65-83a0-1659badd1a04/LIVE%2BBLIND%2BSPEED%2BDATEs%2BSHOWTIME%2B730PM%2BTICKET%2B%2420.png?v=1726333289432" 
          />    
        </div>
      </div>
    </div>
    <footer class="footer">
      <div class="links">
        <a href="https://www.matchmadeonstage.com/">Website</a> ◆ 
        <a href="https://www.instagram.com/matchmadeonstage/">Instagram</a> ◆ 
        Made by <a href="https://brokenshotgun.com/">Broken Shotgun</a>
      </div>
    </footer>
  </body>
</html>
